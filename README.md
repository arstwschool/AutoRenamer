# AI 智慧批量重命名工具

這是一個強大的現代化批量重命名工具，結合了 **RegEx (正規表達式)** 的靈活度與 **OpenAI (GPT-4o/GPT-5)** 的智慧分析能力。

## ✨ 主要功能

* **拖放介面**：直覺的操作方式，直接將檔案拖入視窗即可。
* **RegEx 支援**：支援 Python 標準正規表達式，包含捕獲群組 (`$1`, `$2` 或 `\1`)。
* **AI 智慧命名**：
    * **視覺分析**：可讀取圖片內容 (.jpg, .png) 並根據畫面內容命名。
    * **文件摘要**：支援 PDF, Word (.docx), Excel (.xlsx), 文字檔 (.txt, .md, code...)，讀取內容後自動命名。
    * **自動模型切換**：相容 OpenAI 官方 API 與第三方代理 (自動適配 `max_tokens` 參數)。
* **安全性設計**：
    * 即時預覽。
    * 檔名衝突檢測。
    * **Undo / Redo**：完整的歷史紀錄堆疊，隨時後悔。

## 🛠️ 安裝與執行

### 1. 安裝依賴
確保已安裝 Python 3.10+，並執行：

```bash
pip install -r requirements.txt
```

### 2. 執行程式
```bash
python main.pyw
```

### 📖 使用說明
1. **加入檔案**：將檔案拖曳至啟動視窗，或在編輯介面點擊「+ 加入更多檔案」。
2. **RegEx 重命名**：
    * 在上方輸入 Pattern (查找) 與 Replacement (替換)。
    * 列表會即時顯示預覽結果。
3. **AI 重命名**：
    * 點擊檔案右側的 ✨ 按鈕。
    * 初次使用需輸入 API Endpoint 與 Key。
    * AI 生成的檔名會以藍色顯示，並鎖定該檔案 (不受 RegEx 影響)。
4. **執行**：確認無誤後，點擊綠色「確認並批量重命名」按鈕。

### ⚙️ 技術細節
**GUI Framework**: CustomTkinter
**PDF Engine**: PyMuPDF (Fitz)
**AI Model**: 預設使用 gpt-5-mini (請確保您的 API 支援，或在程式碼中修改)。